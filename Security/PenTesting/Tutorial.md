# Ethcal Hacking tools

The following table lists some of commonly used penetration testing tools along with brief descriptions of their functionalities:

| Tool Name       | Description                                                                                                                                                                         |
|-----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Nmap            | Network mapper - a powerful open-source tool for network discovery, port scanning, service enumeration, and vulnerability detection.                                                |
| Metasploit      | Framework for developing, testing, and executing exploit code against remote targets, facilitating penetration testing and security assessments.                                   |
| Burp Suite      | An integrated platform for performing security testing of web applications. It includes various tools for different phases of web application security testing.                  |
| Wireshark       | A widely-used network protocol analyzer that allows users to capture and interactively browse the traffic running on a computer network.                                             |
| Nikto           | A web server scanner that performs comprehensive tests against web servers for multiple items, including dangerous files, outdated server software, and other potential vulnerabilities. |
| SQLMap          | An open-source penetration testing tool that automates the process of detecting and exploiting SQL injection flaws in web applications.                                              |
| John the Ripper | A fast password cracker, currently available for many flavors of Unix, Windows, DOS, BeOS, and OpenVMS. It can be used for both dictionary attacks and brute force attacks.         |
| Aircrack-ng     | A network software suite consisting of a detector, packet sniffer, WEP and WPA/WPA2-PSK cracker, and analysis tool for 802.11 wireless LANs.                                         |
| Hydra           | A fast and flexible password brute-forcing tool that supports various protocols, including HTTP, HTTPS, FTP, SMTP, SMB, and many others.                                             |
| THC-Hydra       | Another popular password cracker similar to Hydra, supporting multiple protocols and services for brute-force attacks.                                                              |

These tools are essential in the arsenal of penetration testers, enabling them to identify and exploit vulnerabilities in systems and applications to assess overall security posture. As with any security-related activities, it's important to use these tools responsibly and ethically.

# Nmap

Below is a table listing some commonly used flags (options) in Nmap along with brief descriptions of their functionalities:

| Flag (Option)   | Description                                                                                                                                                                                                                                                                                         |
|-----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| -sS             | TCP SYN scan: Sends SYN packets to the target ports and analyzes responses to determine if they are open, closed, or filtered. This is one of the most common scan types and is also known as half-open scanning.                                                                                   |
| -sT             | TCP Connect scan: Actively opens TCP connections to the target ports and examines responses to determine their state. This scan is slower and more detectable compared to SYN scanning, as it completes the full TCP handshake.                                                                      |
| -sU             | UDP scan: Sends UDP packets to the target ports and analyzes responses to determine if they are open, closed, or filtered. Since UDP is connectionless, this scan type relies on responses from services running on those ports, which may not always be reliable.                                        |
| -sV             | Service Version Detection: Attempts to determine the version and nature of services running on open ports by analyzing responses. This can provide valuable information for further assessment and exploitation of vulnerabilities associated with specific service versions.                              |
| -O              | Operating System Detection: Tries to determine the operating system running on the target machine by analyzing various network characteristics such as TTL values, TCP/IP stack behavior, and more. This can help in understanding the target environment better.                                       |
| -A              | Aggressive Scan: Combines various scan types (SYN scan, version detection, OS detection, traceroute, and script scanning) to gather as much information as possible about the target system. This can be more intrusive and resource-intensive but provides comprehensive results.                 |
| -p              | Specifies target ports or port ranges to scan. For example, `-p80` scans port 80, `-p1-1000` scans ports 1 through 1000, and `-p-` scans all 65535 ports.                                                                                                                                              |
| -T              | Timing Template: Adjusts the timing and speed of the scan. There are predefined timing templates ranging from "Paranoid" (slow and stealthy) to "Insane" (fast and aggressive), allowing users to balance between scan speed and stealthiness according to their needs.                             |
| -v              | Verbose Output: Increases the verbosity level of the scan results, providing more detailed information about the scanning process, targets, and responses. This flag can be repeated (`-vv`) to increase verbosity further.                                                                                    |
| -iL             | Input from List: Specifies a file containing a list of target IP addresses or hostnames to scan. This allows scanning multiple targets in a single command by reading them from a text file.                                                                                                           |

These flags are just a subset of the extensive options available in Nmap, providing users with flexibility and control over their scanning activities. It's important to use Nmap responsibly and in compliance with legal and ethical guidelines.

## Examples of using Nmap

Here are some detailed examples of how to use various flags in Nmap:

Certainly! Here are some additional examples of how Nmap can be used for various scanning tasks:

1. **Scan a Range of IP Addresses**:
   ```
   nmap 192.168.1.1-100
   ```
   This command scans a range of IP addresses from 192.168.1.1 to 192.168.1.100.

2. **Scan a Specific Host**:
   ```
   nmap example.com
   ```
   This command scans a single host identified by the domain name "example.com".

3. **Scan Multiple Hosts**:
   ```
   nmap 192.168.1.100 192.168.1.101 192.168.1.102
   ```
   This command scans multiple hosts specified by their IP addresses.

4. **Scan Hosts from a List**:
   ```
   nmap -iL hosts.txt
   ```
   This command reads a list of target IP addresses or hostnames from the file `hosts.txt` and performs scans on each target listed in the file.

5. **Scan All TCP Ports**:
   ```
   nmap -p- 192.168.1.100
   ```
   This command scans all 65535 TCP ports on the target IP address 192.168.1.100.

6. **Scan Top N Most Common Ports**:
   ```
   nmap --top-ports 100 192.168.1.100
   ```
   This command scans the top 100 most common ports on the target IP address 192.168.1.100.

7. **Disable DNS Resolution**:
   ```
   nmap -n 192.168.1.100
   ```
   This command disables DNS resolution, preventing Nmap from attempting to resolve hostnames to IP addresses.

8. **Save Scan Results to a File**:
   ```
   nmap -oN scan_results.txt 192.168.1.100
   ```
   This command saves the scan results to the file `scan_results.txt` in normal format.

9. **Output in XML Format**:
   ```
   nmap -oX scan_results.xml 192.168.1.100
   ```
   This command saves the scan results to the file `scan_results.xml` in XML format, which can be parsed and processed by other tools.

10. **Aggressive Scan with Scripts**:
    ```
    nmap -A 192.168.1.100
    ```
    This command performs an aggressive scan on the target IP address 192.168.1.100, including version detection, OS detection, traceroute, and script scanning.


11. **TCP SYN Scan (-sS)**:
This flag requires root/admin level access;

   ```
   nmap -sS 192.168.1.100

   >> Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-14 13:11 EST
   >> Nmap scan report for 192.168.1.100
   >> Host is up (0.0000040s latency).
   >> Not shown: 999 closed tcp ports (reset)
   >> PORT   STATE SERVICE
   >> 22/tcp open  ssh

   >> Nmap done: 1 IP address (1 host up) scanned in 0.27 seconds
   ```
   This command performs a TCP SYN scan on the target IP address 192.168.1.100. It sends SYN packets to the target ports and analyzes responses to determine their state (open, closed, or filtered).

12. **Service Version Detection (-sV)**:
   ```
   nmap -sV 192.168.1.100

   >> Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-14 13:14 EST
   >> Nmap scan report for 192.168.1.100
   >> Host is up (0.00011s latency).
   >> Not shown: 999 closed tcp ports (conn-refused)
   >> PORT   STATE SERVICE VERSION
   >> 22/tcp open  ssh     OpenSSH 9.6p1 Debian 3 (protocol 2.0)
   >> Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

   >> Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
   >> Nmap done: 1 IP address (1 host up) scanned in 0.85 seconds
   ```
   This command performs a service version detection scan on the target IP address 192.168.1.100. It attempts to determine the version and nature of services running on open ports by analyzing responses.

13. **Operating System Detection (-O)**:
   ```
   nmap -O 192.168.1.100

   >> Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-14 13:20 EST
   >> Nmap scan report for 192.168.1.100
   >> Host is up (0.000038s latency).
   >> Not shown: 999 closed tcp ports (reset)
   >> PORT   STATE SERVICE
   >> 22/tcp open  ssh
   >> Device type: general purpose
   >> Running: Linux 2.6.X
   >> OS CPE: cpe:/o:linux:linux_kernel:2.6.32
   >> OS details: Linux 2.6.32
   >> Network Distance: 0 hops

   >> OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
   >> Nmap done: 1 IP address (1 host up) scanned in 1.54 seconds

   ```
   This command performs an operating system detection scan on the target IP address 192.168.1.100. It tries to determine the operating system running on the target machine by analyzing various network characteristics.

14. **Aggressive Scan (-A)**:
   ```
   nmap -A 192.168.1.100

   >> Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-14 13:31 EST
   >> Nmap scan report for 192.168.100.1
   >> Host is up (0.00019s latency).
   >> Not shown: 999 closed tcp ports (conn-refused)
   >> PORT   STATE SERVICE VERSION
   >> 22/tcp open  ssh     OpenSSH 9.6p1 Debian 3 (protocol 2.0)
   >> | ssh-hostkey:
   >> |   256 9b:fe:5f:93:2a:80:1b:13:74:99:a6:57:2f:03:35:9d (ECDSA)
   >> |_  256 48:f2:37:55:69:6f:e8:ab:0c:51:ad:0a:d6:b9:34:b3 (ED25519)
   >> Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

   >> Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
   >> Nmap done: 1 IP address (1 host up) scanned in 1.95 seconds

   ```
   This command performs an aggressive scan on the target IP address 192.168.1.100. It combines various scan types (SYN scan, version detection, OS detection, traceroute, and script scanning) to gather comprehensive information about the target system.

15. **Specifying Target Ports (-p)**:
   ```
   nmap -p 80,443 192.168.1.100

   >> Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-14 13:38 EST
   >> Nmap scan report for 192.168.50.15
   >> Host is up (0.000075s latency).

   >> PORT    STATE  SERVICE
   >> 80/tcp  closed http
   >> 443/tcp closed https

   >> Nmap done: 1 IP address (1 host up) scanned in 0.06 seconds
   ```
   This command scans only ports 80 and 443 on the target IP address 192.168.1.100. You can also specify port ranges like `-p 1-100` to scan ports 1 through 100 or `-p-` to scan all 65535 ports.

16. **Timing Template (-T)**:
   ```
   nmap -T4 192.168.1.100
   ```
   This command sets the timing template to "Aggressive" (T4), which adjusts the timing and speed of the scan. T4 is faster and more aggressive compared to the default timing template.

17. **Verbose Output (-v)**:
   ```
   nmap -v 192.168.1.100
   ```
   This command increases the verbosity level of the scan results, providing more detailed information about the scanning process, targets, and responses.

18. **Input from List (-iL)**:
   ```
   nmap -iL targets.txt
   ```
   This command reads a list of target IP addresses or hostnames from the file `targets.txt` and performs scans on each target listed in the file.

These examples demonstrate how to use some of the most commonly used flags in Nmap for performing network reconnaissance and security scanning. It's important to use Nmap responsibly and ethically, ensuring compliance with legal regulations and obtaining proper authorization before scanning networks.

## TCP SYN scan

A TCP SYN scan, often referred to as a "half-open" scan, is a type of port scanning method used by network administrators and security professionals to determine which ports on a target system are open, closed, or filtered. This scan works by sending a SYN (synchronize) packet to the target port and analyzing the response.

Here's how a TCP SYN scan typically works:

1. **SYN Packet Sent**: The scanning tool (e.g., Nmap) sends a TCP SYN packet to the target system's ports that need to be scanned. The SYN packet contains the destination port number and a randomly generated sequence number.

2. **Response Analysis**:
   - If the port is open: The target system responds with a SYN-ACK (synchronize-acknowledgment) packet. This indicates that the port is open and waiting for a connection.
   - If the port is closed: The target system responds with a RST (reset) packet. This indicates that the port is closed, and no service is listening on that port.
   - If the port is filtered: If there is no response or an ICMP error message (such as "Destination Unreachable") is received, it suggests that the port may be filtered by a firewall or other network device. This means that the scanning tool did not receive a definitive response from the target system.

3. **No Full Connection Establishment**: Unlike a full TCP connect scan, which completes the TCP three-way handshake (SYN, SYN-ACK, ACK), a TCP SYN scan does not establish a full connection with the target system. This makes it less detectable and intrusive compared to other scanning methods.

Advantages of TCP SYN Scan:
- Stealthy: Since a full TCP connection is not established, TCP SYN scans are less likely to be detected by intrusion detection systems (IDS) or firewall logs.
- Faster: SYN scanning can be faster than other scanning methods because it does not wait for a full TCP handshake to complete.

However, there are some limitations and considerations:
- SYN scans may not accurately detect the state of certain ports that require a full connection to reveal their state (e.g., some UDP ports).
- Some target systems may be configured to detect and respond to SYN scans, although this is less common than with other scanning methods.

Overall, TCP SYN scanning is a powerful and commonly used technique for network reconnaissance and vulnerability assessment due to its speed and stealthiness. It's important for security professionals to use SYN scans responsibly and in accordance with legal and ethical guidelines.

The Nmap Scripting Engine (NSE) is a powerful feature in Nmap that allows users to automate a wide variety of tasks related to network exploration, vulnerability detection, and exploitation. It enables users to write and execute scripts in Lua programming language to extend Nmap's functionality beyond basic port scanning.

## nmap scrpting engine (NSE)

Here are some key aspects of the Nmap Scripting Engine:

1. **Script Categories**: NSE scripts are organized into categories based on their functionality, such as discovery, version detection, vulnerability detection, exploitation, and brute-forcing.

2. **Customization and Extensibility**: Users can write their own NSE scripts or use pre-existing scripts from the Nmap Scripting Library. This allows for customization and extensibility of Nmap's capabilities to suit specific needs and scenarios.

3. **Integration with Scans**: NSE scripts can be integrated seamlessly into Nmap scans using the `--script` or `-sC` option. Users can specify which scripts to run during a scan, or use predefined script categories such as `default` or `vuln` to run a set of scripts targeting common tasks.

4. **Script Output**: NSE scripts can output information in various formats, including plain text, XML, and even interactive output. This makes it easy for users to parse and analyze the results of script execution.

5. **Community Contributions**: The Nmap Scripting Library contains a vast collection of scripts contributed by the community, covering a wide range of network-related tasks and scenarios. Users can also share their own scripts with the community to contribute to the library.

6. **Scripting API**: Nmap provides a rich API for writing NSE scripts, allowing access to various networking functionalities, such as sending and receiving packets, querying network services, interacting with the file system, and more. This API simplifies the process of writing complex scripts and enables developers to create sophisticated automation tools.

7. **Security Considerations**: While NSE scripts can be incredibly useful for automating network tasks, it's important to use them responsibly and ethically. Running certain scripts against systems without proper authorization may violate legal regulations or ethical guidelines. Additionally, poorly written or malicious scripts could potentially cause harm to target systems or networks.

Overall, the Nmap Scripting Engine is a versatile tool that enhances Nmap's capabilities by allowing users to automate and customize network scanning and exploration tasks. When used appropriately, NSE scripts can be invaluable assets for network administrators, security professionals, and researchers alike.

## Examples of nmap scrpting

Below are some detailed examples of using Nmap scripting engine (NSE) for various tasks:

1. **HTTP Enumeration Script (http-enum)**:
   ```
   nmap --script http-enum <target>
   ```
   This script enumerates directories, files, and other resources on web servers. It can help identify hidden or sensitive files and directories that may be accessible through the web server.

2. **Vulnerability Detection Script (vuln)**:
   ```
   nmap --script vuln <target>
   ```
   This script checks for known vulnerabilities on the target system by querying various databases and performing tests. It can identify potential security issues such as outdated software versions or misconfigurations.

3. **SSH Authentication Bypass Script (ssh-brute)**:
   ```
   nmap --script ssh-brute --script-args userdb=<users.txt>,passdb=<passwords.txt> <target>
   ```
   This script performs brute-force attacks against SSH authentication. It tries different combinations of usernames and passwords from the specified user and password lists to gain unauthorized access to SSH services.

4. **DNS Zone Transfer Script (dns-zone-transfer)**:
   ```
   nmap --script dns-zone-transfer <target>
   ```
   This script attempts to perform a DNS zone transfer from the target DNS server. It retrieves a list of DNS records, including hostnames, IP addresses, and other information, which can be useful for reconnaissance purposes.

5. **SMB Version Detection Script (smb-protocols)**:
   ```
   nmap --script smb-protocols <target>
   ```
   This script detects the SMB (Server Message Block) protocol version supported by the target system. It can help identify potential security vulnerabilities or compatibility issues related to SMB services.

6. **FTP Authentication Bypass Script (ftp-brute)**:
   ```
   nmap --script ftp-brute --script-args userdb=<users.txt>,passdb=<passwords.txt> <target>
   ```
   Similar to the SSH brute-force script, this script performs brute-force attacks against FTP authentication. It tries different combinations of usernames and passwords from the specified user and password lists to gain unauthorized access to FTP services.

7. **SNMP Enumeration Script (snmp-enum)**:
   ```
   nmap --script snmp-enum <target>
   ```
   This script enumerates SNMP (Simple Network Management Protocol) information from the target system, such as system information, network interfaces, and installed software. It can help identify potential security risks associated with SNMP services.

8. **SMTP Enumeration Script (smtp-enum-users)**:
   ```
   nmap --script smtp-enum-users <target>
   ```
   This script enumerates email addresses from the target SMTP (Simple Mail Transfer Protocol) server. It can help identify valid email accounts, which may be useful for social engineering or phishing attacks.

These examples demonstrate how Nmap scripting engine (NSE) can be utilized to automate various network reconnaissance, vulnerability assessment, and exploitation tasks. It's important to use these scripts responsibly and ethically, ensuring compliance with legal regulations and obtaining proper authorization before scanning or testing systems.

## Writing nmap scripts

Writing Nmap scripts involves using the Lua programming language to interact with Nmap's Scripting Engine (NSE). Here's a step-by-step guide on how to write Nmap scripts:

1. **Learn Lua**: Lua is a lightweight scripting language commonly used for embedded systems and game development. Familiarize yourself with Lua syntax, data types, control structures, functions, and libraries. Many resources are available online, including tutorials, documentation, and Lua programming books.

2. **Understand Nmap Scripting Engine (NSE)**: Learn about NSE's capabilities, architecture, and scripting API. Understand how scripts can interact with Nmap's scanning engine, access network services, and perform various tasks during a scan.

3. **Choose a Task**: Determine the task or functionality you want to automate with your Nmap script. This could include network enumeration, service version detection, vulnerability scanning, brute-force attacks, or custom tasks specific to your requirements.

4. **Write the Script**: Create a new Lua script file using a text editor or an integrated development environment (IDE). Start by importing necessary Nmap libraries and defining the script's entry point function (`action()`). Within this function, implement the logic to accomplish your chosen task using Nmap's scripting API.

5. **Testing and Debugging**: Test your script on target systems to ensure it behaves as expected. Use the `--script` option with Nmap to run your script against test targets. Monitor the output and debug any errors or unexpected behavior.

6. **Documentation and Comments**: Document your script by adding comments to explain its purpose, functionality, input parameters, and output format. Include usage examples and any prerequisites or dependencies required for running the script successfully.

7. **Contribute to Nmap Scripting Library**: Consider contributing your script to the Nmap Scripting Library (https://github.com/nmap/nmap). Submit a pull request to share your script with the Nmap community and potentially have it included in future releases of Nmap.

8. **Stay Updated**: Keep abreast of changes and updates to Nmap, Lua, and NSE. Follow Nmap's official documentation, mailing lists, and forums to stay informed about new features, best practices, and community contributions.

Here's a simple example of a Lua script that prints "Hello, Nmap!" when executed:

```lua
-- hello-nmap.lua

-- Import Nmap libraries
local nmap = require "nmap"
local shortport = require "shortport"
local stdnse = require "stdnse"

-- Define the script's entry point function
action = function(host, port)
    -- Print "Hello, Nmap!"
    stdnse.print_output("Hello, Nmap!")
end
```

Save this script as `hello-nmap.lua` and run it with Nmap using the `--script` option:

```
nmap --script hello-nmap <target>
```

This script demonstrates the basic structure of an Nmap script and how it interacts with Nmap's scanning engine. You can expand upon this example to create more complex scripts tailored to your specific needs.
